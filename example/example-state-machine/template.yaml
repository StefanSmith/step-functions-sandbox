AWSTemplateFormatVersion: '2010-09-09'
Transform: AWS::Serverless-2016-10-31
Parameters:
  InputTransformerFunctionName:
    Type: String
  DoublerFunctionName:
    Type: String
  OutOfBandDeploymentSupport:
    Type: String
    Default: "false"
Resources:
  StateMachine:
    Type: AWS::Serverless::StateMachine
    Fn::Transform:
      Name: OutOfBandDeploymentSupport
      Parameters:
        Enabled: !Ref OutOfBandDeploymentSupport
    Properties:
      DefinitionUri: statemachine.asl.yaml
      DefinitionSubstitutions:
        InputTransformerFunctionName: !Ref InputTransformerFunctionName
        DoublerFunctionName: !Ref DoublerFunctionName
      Policies:
        - LambdaInvokePolicy:
            FunctionName: !Ref InputTransformerFunctionName
        - LambdaInvokePolicy:
            FunctionName: !Ref DoublerFunctionName
Outputs:
  StateMachineArn:
    Value: !Ref StateMachine